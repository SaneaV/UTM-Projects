% Метод скользящего среднего (Moving Average)
% Сглаживание сигнала путём усреднения

% Инициализация графика
clf;

% Параметры сигнала
R = 51;
d = 2 * (rand(R, 1) - 0.5); % Генерация случайного шума
m = 0:R-1;
s = 2 * m .* (0.85 .^ m); % Генерация чистого сигнала
x = s + d'; % Генерация искажённого шумом сигнала

% Визуализация исходного сигнала, шума и искажённого сигнала
subplot(2,1,1);
plot(m, d', 'r-', m, s, 'g--', m, x, 'b-.');
xlabel('Время n'); ylabel('Амплитуда');
legend('Шум d[n]', 'Чистый сигнал s[n]', 'Искажённый сигнал x[n]');
title('Исходный сигнал, шум и искажённый сигнал');

% Применение метода скользящего среднего
x1 = [0 0 0 0 0 x]; x2 = [0 0 0 0 x 0]; x3 = [0 0 0 x 0 0];
x4 = [0 0 x 0 0 0]; x5 = [0 x 0 0 0 0]; x6 = [x 0 0 0 0 0];
y = (x1 + x2 + x3 + x4 + x5 + x6) / 6;

% Отображение результатов сглаживания
subplot(2,1,2);
plot(m, y(2:R+1), 'r-', m, s, 'g--');
legend('Сглаженный сигнал y[n]', 'Чистый сигнал s[n]');
xlabel('Время n'); ylabel('Амплитуда');
title('Сглаживание сигнала методом скользящего среднего');

