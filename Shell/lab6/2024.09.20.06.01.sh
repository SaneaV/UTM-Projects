# Процесс «Генератор» считывает строки с консоли, пока ему на вход не поступит строка TERM. В этом случае он посылает системный сигнал SIGTERM процессу обработчику. Процесс «Обработчик» (как и в примере, выводящий в бесконечном цикле натуральное число каждую секунду) должен перехватить системный сигнал SIGTERM и завершить работу, предварительно выведя сообщение о завершении работы по сигналу от другого процесса.

#!/bin/bash

# Функция-обработчик для перехвата сигнала SIGTERM
# Эта функция будет вызываться, когда процесс получит сигнал SIGTERM.
# Она выводит сообщение о завершении работы по сигналу и корректно завершает процесс.
terminate_handler() {
  echo "Обработчик завершает работу по сигналу SIGTERM от другого процесса."
  # Завершение работы скрипта с кодом выхода 0 (успешное завершение).
  exit 0
}

# Команда trap указывает, что при получении сигнала SIGTERM
# необходимо вызвать функцию terminate_handler.
trap 'terminate_handler' SIGTERM

# Инициализация счетчика для вывода натуральных чисел.
# Начинаем с 1.
counter=1

# Бесконечный цикл для вывода чисел.
# Скрипт будет работать до тех пор, пока не получит сигнал на завершение (например, SIGTERM).
while true
do
  # Выводим текущее значение счетчика.
  echo "Число: $counter"
  
  # Увеличиваем значение счетчика на 1.
  counter=$((counter + 1))
  
  # Задержка на 1 секунду между выводом чисел.
  # Это сделано для того, чтобы числа выводились каждую секунду.
  sleep 1
done
