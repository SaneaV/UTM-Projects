# Процесс «Генератор» считывает с консоли строки в бесконечном цикле. Если считанная строка содержит единственный символ «+», он посылает процессу «Обработчик» сигнал USR1. Если строка содержит единственный символ «*», генератор посылает обработчику сигнал USR2. Если строка содержит слово TERM, генератор посылает обработчику сигнал SIGTERM. Другие значения входных строк игнорируются. Обработчик добавляет 2 или умножает на 2 текущее значение обрабатываемого числа (начальное значение принять на единицу) в зависимости от полученного пользовательского сигнала и выводит результат на экран. Вычисление и вывод производятся один раз в секунду. Получив сигнал SIGTERM, «Обработчик» завершает свою работу, выведя сообщения о завершении работы по сигналу от другого процесса.

#!/bin/bash

# --- Скрипт для процесса "Генератор" ---
# Этот скрипт считывает команды от пользователя и отправляет соответствующие сигналы
# процессу "Обработчик", который должен реагировать на эти сигналы.

# Запрашиваем у пользователя PID процесса "Обработчик"
# Пользователь должен ввести PID процесса, которому будут отправляться сигналы
echo "Введите PID процесса обработчика:"
read handler_pid

# Бесконечный цикл для чтения команд с консоли
# Цикл будет работать до тех пор, пока не будет введена команда TERM
while true
do
  # Запрос на ввод команды от пользователя
  echo "Введите команду (+ для сигнала USR1, * для сигнала USR2, TERM для SIGTERM):"
  read input  # Чтение ввода пользователя
  
  # --- Отправка сигнала USR1 ---
  # Если пользователь вводит "+", процесс "Генератор" отправляет сигнал USR1 процессу "Обработчик"
  if [ "$input" == "+" ]; then
    kill -USR1 $handler_pid  # Отправка сигнала USR1
    echo "Сигнал USR1 отправлен процессу с PID $handler_pid"  # Информация о том, что сигнал отправлен
  
  # --- Отправка сигнала USR2 ---
  # Если пользователь вводит "*", процесс "Генератор" отправляет сигнал USR2 процессу "Обработчик"
  elif [ "$input" == "*" ]; then
    kill -USR2 $handler_pid  # Отправка сигнала USR2
    echo "Сигнал USR2 отправлен процессу с PID $handler_pid"  # Информация о том, что сигнал отправлен
  
  # --- Отправка сигнала SIGTERM ---
  # Если пользователь вводит "TERM", процесс "Генератор" отправляет сигнал SIGTERM для завершения работы "Обработчика"
  elif [ "$input" == "TERM" ]; then
    kill -SIGTERM $handler_pid  # Отправка сигнала SIGTERM
    echo "Сигнал SIGTERM отправлен процессу с PID $handler_pid"  # Сообщение о том, что сигнал SIGTERM отправлен
    break  # Прерываем цикл, завершая работу генератора
  fi
done

# Завершение работы генератора после отправки команды TERM
echo "Генератор завершил работу."
